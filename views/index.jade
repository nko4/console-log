!!!
html
  head
    title Mothereffing GIFSockets!!!
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    link(href="/public/css/bootstrap.min.css", rel="stylesheet", type="text/css", media="all")
    link(href="/public/css/bootstrap-responsive.min.css", rel="stylesheet", type="text/css", media="all")
    style.
      body {
        background: url(/public/img/background.png);
      }

      body,
      textarea,
      input,
      .btn {
        font-size: 16px;
        line-height: 24px;
      }

      /* TODO: Make image full width of container (whatever that is) */
      .gifsocket {
        width: 600px;
        height: 392px;
        background: #666;
        display: block;
        margin: 0 auto;
      }

      /* TODO: This should be under a media query */
      .header h1 {
        font-size: 70px;
        line-height: 120px;
      }

      .push--top {
        margin-top: 60px;
      }

  body
    .container
      .header.text-center
        h1 Mothereffing GIFSockets!!!
      .well
        :markdown
          GIFSockets are animated [GIFs][] that never end. We keep an open connection and write new frames as they come in.

          Try typing and submitting some text below!

          [GIFs]: http://en.wikipedia.org/wiki/Graphics_Interchange_Format

      p.text-center
        iframe(src="//nodeknockout.com/iframe/console-log",
               frameborder=0, scrolling=no,
               allowtransparency=true, width=115, height=25)
      .row.text-center
        p.span12.text-center
          //- TODO: Put up some <canvas> based placeholder text until first submit
          img.gifsocket(src="/image.gif")
      div
        iframe.hidden(name="request-frame", width=0, height=0)
        form#gifsocket-form(method="POST", action="/image/text", target="request-frame")
          .row
            .span12
              textarea.input-block-level(id="gifsocket-text", name="text") Hello World!
          .row
            .span12
              button.btn.btn-block Submit
      div.push--top
        .section
          h2.text-center Explanation
          .well
            :markdown
              If you think you have seen this before,
              you have. [GIFSockets][] were originally
              implemented in [Clojure][] using [Java][]
              libraries for [GIF][] encoding.

              [GIFSockets]: https://github.com/videlalvaro/gifsockets
              [Clojure]: http://en.wikipedia.org/wiki/Clojure
              [Java]: http://en.wikipedia.org/wiki/Java_%28programming_language%29
              [GIF]: http://en.wikipedia.org/wiki/Graphics_Interchange_Format

              Unfortunately, it was not trivial to set up.
              Especially if you have not had experience with
              [Clojure][] in the past.

              This project is a reimplementation in [JavaScript][]
              using a fork of [gif.js][] for encoding and
              [PhantomJS][] for [canvas][] preparation.

              [JavaScript]: http://en.wikipedia.org/wiki/ECMAScript
              [gif.js]: http://jnordberg.github.io/gif.js/
              [PhantomJS]: http://phantomjs.org/
              [canvas]: https://developer.mozilla.org/en-US/docs/HTML/Canvas

              To run this website locally:

              ```bash
              git clone https://github.com/nko4/console-log
              cd console-log
              npm install
              npm start
              # Website will be available at http://localhost:8000/
              ```

    script.
      //- TODO: Drag and drop bindings
      var _gaq = _gaq || [];
      _gaq.push([
        '_setAccount',
        window.location.href.indexOf('localhost') === -1 ? 'UA-45607410-1' : 'UA-45607410-2'
      ]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);

        var $gifsocketForm = document.getElementById('gifsocket-form');
        var $gifsocketText = document.getElementById('gifsocket-text');
        $gifsocketForm.onsubmit = function () {
          var text = $gifsocketText.value;
          _gaq.push(['_trackEvent', 'Form submit', text]);
        };
      })();
    script(src="/public/js/filereader.js")
    script.
      (function () {
        if (document.getElementsByClassName && document.body.addEventListener) {
          var $gifsocket = document.getElementsByClassName('gifsocket')[0];

          var $modal = document.createElement('div');
          $modal.className = 'modal';
          $modal.innerHTML = [
            '<div class="modal-header">',
            '  <button type="button" class="close modal-close" aria-hidden="true">&times;</button>',
            '  <h3 id="modal-h3">Header</h3>',
            '</div>',
            '<div class="modal-body">',
            '  <p id="modal-content">Content</p>',
            '</div>',
            '<div class="modal-footer">',
            '  <a href="#" class="btn btn-primary modal-close">Okay</a>',
            '</div>'
          ].join('');
          var $modalBackdrop = document.createElement('div');
          $modalBackdrop.className = 'modal-backdrop fade in';
          document.body.appendChild($modal);
          document.body.appendChild($modalBackdrop);

          FileReaderJS.setupDrop($gifsocket, {
            on: {
              loadstart: function (e, file) {
                console.log('hi', file);
              },
              load: function (e, file) {
                console.log('hi2', file);
              },
              skip: function (file) {
                console.log('skip', file);
              }
            }
          });
          //- FileReaderJS.setupClipboard(document.body, opts);
        }
      }());

  //- end of body
